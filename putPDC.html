<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modificar Cuenta</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <h3>Modificar Cuenta</h3>

    <label for="modRubro">Rubro:</label>
    <input type="text" id="modRubro" name="modRubro" required>
    
    <label for="modNroCuenta">Nro Cuenta:</label>
    <input type="number" id="modNroCuenta" name="modNroCuenta" readonly required>
    
    <label for="modDescripcion">Descripción:</label>
    <input type="text" id="modDescripcion" name="modDescripcion" required>
    
    <button type="button" onclick="guardarModificacion()">Guardar Modificación</button>

    <script>
        // Obtener parámetros de la URL
        const urlParams = new URLSearchParams(window.location.search);
        const rubro = urlParams.get('rubro');
        const nroCuenta = urlParams.get('nroCuenta');
        const descripcion = urlParams.get('descripcion');

        // Asignar valores a los campos
        document.getElementById('modRubro').value = rubro;
        document.getElementById('modNroCuenta').value = nroCuenta;
        document.getElementById('modDescripcion').value = descripcion;

        // Función para guardar la modificación
        function guardarModificacion() {
            // Obtener los valores modificados
            const modRubro = document.getElementById('modRubro').value.toUpperCase();
            const modNroCuenta = document.getElementById('modNroCuenta').value;
            const modDescripcion = document.getElementById('modDescripcion').value;

            // Datos para enviar en la solicitud
            const requestData = {
                rubro: modRubro,
                nroCuenta: modNroCuenta,
                descripcion: modDescripcion,
                accion: 'modificar'
            };

            // Hacer la solicitud Fetch al endpoint de la API para modificar la cuenta
            fetch("api.php", {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(requestData)
            })
            .then(response => response.json())
            .then(data => {
                if (data && data.message) {
                    alert(data.message);
                } else {
                    console.error("Respuesta inesperada del servidor:", data);
                }
                // Cerrar la ventana después de guardar las modificaciones
                window.close();
                // Puedes redirigir a otra página si lo deseas
                // window.location.href = 'otra_pagina.html';
            })
            .catch(error => console.error("Error al modificar la cuenta:", error));
        }
    </script>

</body>
</html>